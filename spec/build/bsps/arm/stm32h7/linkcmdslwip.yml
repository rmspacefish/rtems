build-type: script
do-build: |
  bld.install_as("${BSP_LIBDIR}/linkcmds.lwip", "linkcmds.lwip")
do-configure: |
  content = """SECTIONS {
      /* This places the DMA descriptors for lwIP at the start of SRAM3.
      The MPU still needs to be configured for the DMA descriptor regions to be 
      bufferable, non-cacheable, non-shareable (first 256 bytes) */
      .lwip_sec (NOLOAD) : ALIGN_WITH_INPUT {
          . = ABSOLUTE(0x30040000);
          *(.RxDecripSection)
          . = ABSOLUTE(0x30040060);
          *(.TxDecripSection)
          . = ABSOLUTE(0x30040200);
          *(.RxArraySection)
      } >SRAM_3 AT> REGION_TEXT_LOAD
  }
  """
  
  f = conf.bldnode.make_node(
      conf.env.VARIANT + "/linkcmds.lwip"
  )
  f.parent.mkdir()
  f.write(content)
  conf.env.append_value("cfg_files", f.abspath())
enabled-by: true
links: []
prepare-build: null
prepare-configure: null
type: build
SPDX-License-Identifier: CC-BY-SA-4.0 OR BSD-2-Clause
copyrights:
- Copyright (C) 2020 Robin Mueller
